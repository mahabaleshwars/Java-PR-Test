name: Test Basic Usage and Gradle Versions

on:
 push:
 workflow_dispatch:

jobs:
  # Scenario:  General usage - basic setup with Gradle wrapper
  basic-setup-multi-platform:
    name: Basic Setup - ${{ matrix.os }}
    strategy:
      matrix: 
        os: [ubuntu-latest, macos-latest, windows-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 17

      - name: Setup Gradle
        uses:  gradle/actions/setup-gradle@v5

  # Scenario:  Build with a specific Gradle version
  specific-gradle-version: 
    name:  Specific Gradle Version
    runs-on:  ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with: 
          distribution: temurin
          java-version: 17

      - name: Setup Gradle 8. 10
        uses: gradle/actions/setup-gradle@v5
        with:
          gradle-version: '8.10'

      - name: Build with Gradle 8.10
        run: gradle build

  # Scenario:  Test with Gradle version aliases
  gradle-version-aliases:
    name: Gradle Alias - ${{ matrix.gradle-version }}
    strategy:
      fail-fast: false
      matrix:
        gradle-version: 
          - wrapper
          - current
          - release-candidate
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with: 
          distribution: temurin
          java-version: 17

      - name: Setup Gradle with alias ${{ matrix.gradle-version }}
        uses: gradle/actions/setup-gradle@v5
        id: setup-gradle
        with:
          gradle-version: ${{ matrix.gradle-version }}

      - name: Build with Gradle
        run: gradle build --dry-run

      - name: Report Gradle version
        run: echo "The Gradle version was ${{ steps.setup-gradle.outputs.gradle-version }}"

  # Scenario:  Test latest Gradle release candidate (scheduled)
  test-latest-gradle-rc:
    name: Test Latest Gradle RC
    runs-on: ubuntu-latest
    steps: 
      - uses:  actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 17

      - uses: gradle/actions/setup-gradle@v5
        id: setup-gradle
        with:
          gradle-version: release-candidate

      - name: Test build configuration with RC
        run:  gradle build --dry-run

      - name: Report RC version
        run:  echo "The release-candidate version was ${{ steps.setup-gradle.outputs.gradle-version }}"

  # Scenario: Test nightly Gradle versions
  gradle-nightly-versions:
    name:  Gradle Nightly - ${{ matrix.gradle-version }}
    continue-on-error:  true
    strategy: 
      fail-fast: false
      matrix:
        gradle-version: 
          - nightly
          - release-nightly
    runs-on: ubuntu-latest
    steps: 
      - uses: actions/checkout@v4
      - uses:  actions/setup-java@v4
        with:
          distribution: temurin
          java-version:  17

      - name: Setup Gradle ${{ matrix.gradle-version }}
        uses: gradle/actions/setup-gradle@v5
        id: setup-gradle
        with:
          gradle-version: ${{ matrix.gradle-version }}

      - name: Build with nightly Gradle
        run: gradle build --dry-run

      - name: Report version
        run: echo "The ${{ matrix.gradle-version }} version was ${{ steps.setup-gradle.outputs.gradle-version }}"
